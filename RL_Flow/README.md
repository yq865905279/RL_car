# æœºå™¨äººçŠ¶æ€ç›‘æ§ä¸OCRè¯†åˆ«æœåŠ¡
è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„æœºå™¨äººçŠ¶æ€ç›‘æ§ç³»ç»Ÿï¼ŒåŒ…å«ä¸¤ä¸ªFastAPIæœåŠ¡ï¼š

1. **PaddleOCRæœåŠ¡** - å›¾åƒæ–‡å­—è¯†åˆ«
2. **æœºå™¨äººçŠ¶æ€ç›‘æ§æœåŠ¡** - å®æ—¶ç›‘æ§æœºå™¨äººè¿è¡ŒçŠ¶æ€

## ç³»ç»Ÿæ¶æ„

```
Webotsæœºå™¨äºº
    â”œâ”€â”€ å›¾åƒè¯†åˆ«è¯·æ±‚ â†’ FastAPI OCRæœåŠ¡ (ç«¯å£8008)
    â””â”€â”€ çŠ¶æ€æ•°æ®å‘é€ â†’ æœºå™¨äººçŠ¶æ€ç›‘æ§æœåŠ¡ (ç«¯å£8009)
```

## å¿«é€Ÿå¯åŠ¨

### 1. å¯åŠ¨PaddleOCRæœåŠ¡

```bash
cd ./paddle_ocr_ros
python fastapi_ocr_service.py
```

æœåŠ¡åœ°å€ï¼šhttp://127.0.0.1:8008

### 2. å¯åŠ¨æœºå™¨äººçŠ¶æ€ç›‘æ§æœåŠ¡

```bash
cd ./robot_status_backend
python robot_status_service.py
```

æœåŠ¡åœ°å€ï¼šhttp://127.0.0.1:8009
ç›‘æ§ä»ªè¡¨æ¿ï¼šhttp://127.0.0.1:8009/

### 3. è¿è¡Œæœºå™¨äººæ§åˆ¶å™¨

åœ¨Webotsä¸­è¿è¡Œï¼š
```bash
cd ../rosbot_navigation
python test_model_webots.py
```

## åŠŸèƒ½ç‰¹æ€§

### PaddleOCRæœåŠ¡ (ç«¯å£8008)

- **POST /recognize** - å›¾åƒæ–‡å­—è¯†åˆ«
- **GET /stats** - æœåŠ¡ç»Ÿè®¡ä¿¡æ¯
- **GET /health** - å¥åº·æ£€æŸ¥

### æœºå™¨äººçŠ¶æ€ç›‘æ§æœåŠ¡ (ç«¯å£8009)

- **POST /status** - æ¥æ”¶æœºå™¨äººçŠ¶æ€æ›´æ–°
- **GET /status** - è·å–å½“å‰æœºå™¨äººçŠ¶æ€
- **GET /status/history** - è·å–çŠ¶æ€å†å²è®°å½•
- **GET /stats** - è·å–æœåŠ¡ç»Ÿè®¡ä¿¡æ¯
- **GET /** - å®æ—¶ç›‘æ§ä»ªè¡¨æ¿

## æœºå™¨äººæ§åˆ¶å™¨åŠŸèƒ½

### é”®ç›˜æ§åˆ¶
- **W** - å‰è¿›
- **S** - åé€€
- **A** - å·¦è½¬
- **D** - å³è½¬
- **S** - æ‰‹åŠ¨å‘é€çŠ¶æ€
- **C** - æ‹ç…§å¹¶å‘é€OCRè¯†åˆ«
- **Q** - é€€å‡º

### è‡ªåŠ¨åŠŸèƒ½
- å®æ—¶å‘é€æœºå™¨äººçŠ¶æ€åˆ°ç›‘æ§åç«¯
- æ˜¾ç¤ºæ‘„åƒå¤´å›¾åƒ
- æ‰“å°ä¼ æ„Ÿå™¨æ•°æ®

## ç›‘æ§ä»ªè¡¨æ¿

è®¿é—® http://127.0.0.1:8009/ å¯ä»¥çœ‹åˆ°ï¼š

- ğŸ“Š **æœåŠ¡ç»Ÿè®¡** - æ€»æ›´æ–°æ¬¡æ•°ã€å†å²è®°å½•æ•°ã€æœ€åæ›´æ–°æ—¶é—´
- ğŸš€ **å½“å‰çŠ¶æ€** - æœºå™¨äººIDã€çº¿é€Ÿåº¦ã€è§’é€Ÿåº¦ã€è¯¦ç»†é€Ÿåº¦ä¿¡æ¯
- ğŸ“ˆ **å†å²è®°å½•** - çŠ¶æ€å˜åŒ–å†å²è¡¨æ ¼ï¼Œè‡ªåŠ¨åˆ·æ–°

ä»ªè¡¨æ¿æ¯5ç§’è‡ªåŠ¨åˆ·æ–°ï¼Œå®æ—¶æ˜¾ç¤ºæœºå™¨äººçŠ¶æ€ã€‚

## APIä½¿ç”¨ç¤ºä¾‹

### å‘é€å›¾åƒè¿›è¡ŒOCRè¯†åˆ«

```python
import requests

# å‘é€å›¾åƒæ–‡ä»¶
with open('image.jpg', 'rb') as f:
    files = {'file': ('image.jpg', f, 'image/jpeg')}
    response = requests.post('http://127.0.0.1:8008/recognize', files=files)
    result = response.json()
    print(f"è¯†åˆ«ç»“æœ: {result['total_text']}")
```

### å‘é€æœºå™¨äººçŠ¶æ€

```python
import requests

status_data = {
    "linear_velocity": {"x": 0.5, "y": 0.0, "z": 0.0},
    "angular_velocity": {"x": 0.0, "y": 0.0, "z": 0.1},
    "robot_id": "robot_01",
    "status_message": "æ­£åœ¨å‰è¿›"
}

response = requests.post('http://127.0.0.1:8009/status', json=status_data)
result = response.json()
print(f"çŠ¶æ€æ›´æ–°: {result['message']}")
```

## æ•°æ®æ ¼å¼

### æœºå™¨äººçŠ¶æ€æ•°æ®ç»“æ„

```json
{
    "timestamp": 1640995200.0,
    "linear_velocity": {"x": 0.5, "y": 0.0, "z": 0.0},
    "angular_velocity": {"x": 0.0, "y": 0.0, "z": 0.1},
    "position": {"x": 1.0, "y": 2.0, "z": 0.0},
    "orientation": {"x": 0.0, "y": 0.0, "z": 0.5, "w": 0.866},
    "battery_level": 85.5,
    "status_message": "æ­£åœ¨æ‰§è¡Œä»»åŠ¡",
    "robot_id": "robot_01"
}
```

### OCRè¯†åˆ«ç»“æœç»“æ„

```json
{
    "success": true,
    "message": "recognized_lines=2, time=1.23s",
    "texts": ["è¯†åˆ«åˆ°çš„æ–‡å­—1", "è¯†åˆ«åˆ°çš„æ–‡å­—2"],
    "confidences": [0.95, 0.87],
    "total_text": "è¯†åˆ«åˆ°çš„æ–‡å­—1 è¯†åˆ«åˆ°çš„æ–‡å­—2",
    "processing_time": 1.23,
    "request_id": 1
}
```